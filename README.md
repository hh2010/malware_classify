## Malware Classification Project

## Overview
This is the GitHub repository for the [Malware Classification project](http://www.hasanhaq.com/malware_classify) I did
for Metis. I used scikit-learn to train classification models (Random Forests,
Logistic Regression, and SVM) using **bi-directional packet flows**.  In my
[Jupyter notebook](malware_training.ipynb) for the project, you will see how I trained the
model and pickled them in the [live](/live) folder.

The [training data](http://mcfp.weebly.com/ctu-malware-capture-botnet-42.html) was gathered from the Malware Capture Facility Project (MCFP)</a> from the Czech Technical University (CTU).  Right now, the model seems to work well on classifying the [Neris](https://www.hybrid-analysis.com/sample/527da5fd4e501765cdd1bccb2f7c5ac76c0b22dfaf7c24e914df4e1cb8029d71?environmentId=1) malware strain, but has not been tested
on any other types.  As I move on to other projects, I am very interested
if people can test this model and generalize it to more malware types.

## Packet Flows
Packet flows are created using [Argus](https://www.qosient.com/argus/) and
a packet capture file which you can generate using [Wireshark](https://www.wireshark.org/) or [tcpdump](http://www.tcpdump.org/).  

Check out the [Argus documentation](http://qosient.com/argus/manuals.shtml) and you
will find that it is easy to generate packet flow records using **Argus** and **Radium.**

Make sure you use the configuration files in the [live](/live) folder when generating
your flow records for testing.  

## Live Test Example

Once you have generated the packet flow CSV using Argus and the corresponding
configuration files found in the [live](/live) folder, use the command below
to output the results of the classification model to your console.

```
./live_test.py --input_csv live/live.csv
```

## Contact
If you have any questions or comments on this project, you can find me below:

E-mail: [hasan.haq@gmail.com](mailto:hasan.haq@gmail.com)
